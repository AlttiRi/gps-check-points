import{d as k,c as D,r as y,e as I,o as l,a as u,b as o,F as v,f as g,g as S,t as f,u as P,h as O,s as L,i as N,p as w,j as A,k as H,l as B}from"./vendor.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const _ of n.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&i(_)}).observe(document,{childList:!0,subtree:!0});function a(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=a(s);fetch(s.href,n)}})();const b=r=>(w("data-v-7d2fa9a8"),r=r(),A(),r),E={class:"main"},J=["disabled"],V={key:0,class:"coord"},F={class:"date"},$=b(()=>o("td",null,"timestamp",-1)),G={class:"saved"},R={key:0,class:"saved-coord"},U=b(()=>o("hr",null,null,-1)),q={class:"date"},K=b(()=>o("hr",null,null,-1)),T=k({__name:"Main",setup(r){const d=D("GPS_Points_DB","GPS_Points"),a=y(),i=y([]);(async function(){const c=await I(d);for(const t of c)i.value.push({timestamp:t[0],coords:t[1]});i.value=i.value.reverse()})();async function s(){return new Promise((e,c)=>{navigator.geolocation.getCurrentPosition(t=>e(t),t=>c(t),{enableHighAccuracy:!0})})}function n(e){const c={};for(const t in e){if(x(e[t])){c[t]=n(e[t]);continue}c[t]=e[t]}return c}async function _(){try{a.value=await s(),m.value=!1}catch(e){alert(JSON.stringify(n(e),null,"  "))}}_();const m=y(!1);async function j(){if(a.value)try{await L(a.value.timestamp,n(a.value.coords),d),i.value.unshift(n(a.value)),m.value=!0}catch(e){alert(JSON.stringify(n(e),null,"  "))}}function x(e){return typeof e=="object"&&!Array.isArray(e)&&e!==null}async function M(){const e=[...i.value];e.sort((t,p)=>t.timestamp-p.timestamp);const c=JSON.stringify(e);return console.log(c),c}async function Y(){if(!navigator.canShare){alert("Sharing is not supported");return}const e={title:btoa(await M())};try{await navigator.share(e)}catch(c){alert(JSON.stringify(n(c),null,"  "))}}return(e,c)=>(l(),u(v,null,[o("div",E,[o("button",{onClick:_},"Update Point"),o("button",{onClick:j,disabled:m.value},"Save Point",8,J),o("button",{onClick:Y},"Share"),a.value?(l(),u("table",V,[(l(!0),u(v,null,g(Object.entries(n(a.value.coords)).filter(([t,p])=>p),([t,p])=>(l(),u("tr",null,[o("td",null,f(t),1),S(": "),o("td",null,f(p),1)]))),256)),o("tr",F,[$,S(": "),o("td",null,f(P(N)(a.value.timestamp,"YYYY.MM.DD HH:mm:SS",!1)),1)])])):O("",!0)]),o("div",G,[i.value.length?(l(),u("div",R,[U,(l(!0),u(v,null,g(i.value,t=>(l(),u("div",null,[o("div",q,f(P(N)(t.timestamp,"YYYY.MM.DD HH:mm:SS",!1)),1),(l(!0),u(v,null,g(Object.entries(t.coords).filter(([p,h])=>h),([p,h])=>(l(),u("div",null,[o("span",null,f(p),1),S(": "),o("span",null,f(h),1)]))),256)),K]))),256))])):O("",!0)])],64))}});const C=(r,d)=>{const a=r.__vccOpts||r;for(const[i,s]of d)a[i]=s;return a},z=C(T,[["__scopeId","data-v-7d2fa9a8"]]),Q=r=>(w("data-v-2724c669"),r=r(),A(),r),W=Q(()=>o("a",{class:"readme",title:"Open Readme",href:"https://github.com/AlttiRi/gps-test",target:"_blank"},[o("i",null,"i")],-1)),X=k({__name:"App",setup(r){return(d,a)=>(l(),u(v,null,[H(z),W],64))}});const Z=C(X,[["__scopeId","data-v-2724c669"]]);B(Z).mount("#app");
//# sourceMappingURL=index.js.map
