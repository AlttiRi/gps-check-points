import{d as x,c as D,r as y,e as I,o as l,a as u,b as o,F as v,f as g,g as S,t as f,u as P,h as O,s as L,i as E,j as H,k as w,p as N,l as k,m as B,n as J}from"./vendor.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const _ of n.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&i(_)}).observe(document,{childList:!0,subtree:!0});function a(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=a(s);fetch(s.href,n)}})();const b=r=>(N("data-v-377a3638"),r=r(),k(),r),V={class:"main"},F=["disabled"],$={key:0,class:"coord"},G={class:"date"},R=b(()=>o("td",null,"timestamp",-1)),T={class:"saved"},U={key:0,class:"saved-coord"},q=b(()=>o("hr",null,null,-1)),K={class:"date"},z=b(()=>o("hr",null,null,-1)),Q=x({__name:"Main",setup(r){const d=D("GPS_Points_DB","GPS_Points"),a=y(),i=y([]);(async function(){const c=await I(d);for(const e of c)i.value.push({timestamp:e[0],coords:e[1]});i.value=i.value.reverse()})();async function s(){return new Promise((t,c)=>{navigator.geolocation.getCurrentPosition(e=>t(e),e=>c(e),{enableHighAccuracy:!0})})}function n(t){const c={};for(const e in t){if(j(t[e])){c[e]=n(t[e]);continue}c[e]=t[e]}return c}async function _(){try{a.value=await s(),h.value=!1}catch(t){alert(JSON.stringify(n(t),null,"  "))}}_();const h=y(!1);async function C(){if(a.value)try{await L(a.value.timestamp,n(a.value.coords),d),i.value.unshift(n(a.value)),h.value=!0}catch(t){alert(JSON.stringify(n(t),null,"  "))}}function j(t){return typeof t=="object"&&!Array.isArray(t)&&t!==null}async function M(){const t=[...i.value];t.sort((e,p)=>e.timestamp-p.timestamp);const c=JSON.stringify(t);return console.log(c),c}async function Y(){if(!navigator.canShare){alert("Sharing is not supported");return}const c={title:E(await new Promise(async e=>H(new TextEncoder().encode(await M()),(p,m)=>{e(m)})))};try{await navigator.share(c)}catch(e){alert(JSON.stringify(n(e),null,"  "))}}return(t,c)=>(l(),u(v,null,[o("div",V,[o("button",{onClick:_},"Update Point"),o("button",{onClick:C,disabled:h.value},"Save Point",8,F),o("button",{onClick:Y},"Share"),a.value?(l(),u("table",$,[(l(!0),u(v,null,g(Object.entries(n(a.value.coords)).filter(([e,p])=>p),([e,p])=>(l(),u("tr",null,[o("td",null,f(e),1),S(": "),o("td",null,f(p),1)]))),256)),o("tr",G,[R,S(": "),o("td",null,f(P(w)(a.value.timestamp,"YYYY.MM.DD HH:mm:SS",!1)),1)])])):O("",!0)]),o("div",T,[i.value.length?(l(),u("div",U,[q,(l(!0),u(v,null,g(i.value,e=>(l(),u("div",null,[o("div",K,f(P(w)(e.timestamp,"YYYY.MM.DD HH:mm:SS",!1)),1),(l(!0),u(v,null,g(Object.entries(e.coords).filter(([p,m])=>m),([p,m])=>(l(),u("div",null,[o("span",null,f(p),1),S(": "),o("span",null,f(m),1)]))),256)),z]))),256))])):O("",!0)])],64))}});const A=(r,d)=>{const a=r.__vccOpts||r;for(const[i,s]of d)a[i]=s;return a},W=A(Q,[["__scopeId","data-v-377a3638"]]),X=r=>(N("data-v-2724c669"),r=r(),k(),r),Z=X(()=>o("a",{class:"readme",title:"Open Readme",href:"https://github.com/AlttiRi/gps-test",target:"_blank"},[o("i",null,"i")],-1)),ee=x({__name:"App",setup(r){return(d,a)=>(l(),u(v,null,[B(W),Z],64))}});const te=A(ee,[["__scopeId","data-v-2724c669"]]);J(te).mount("#app");
//# sourceMappingURL=index.js.map
