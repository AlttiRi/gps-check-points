import{d as k,c as T,r as y,o as p,a as _,b as n,F as m,e as g,f as S,t as f,u as O,g as w,h as B,s as x,i as L,j as H,k as J,l as V,m as N,p as j,n as A,q as F,v as $}from"./vendor.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function a(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(o){if(o.ep)return;o.ep=!0;const i=a(o);fetch(o.href,i)}})();const b=r=>(j("data-v-47dca62f"),r=r(),A(),r),q={class:"main"},G=["disabled"],R={key:0,class:"coord"},U={class:"date"},K=b(()=>n("td",null,"timestamp",-1)),z={class:"saved"},Q={key:0,class:"saved-coord"},W=b(()=>n("hr",null,null,-1)),X={class:"date"},Z=b(()=>n("hr",null,null,-1)),ee=k({__name:"Main",setup(r){const d=T("GPS_Points_DB","GPS_Points"),a=y(),c=y([]);async function o(){const e=await B(d);c.value=[];for(const s of e)c.value.push({timestamp:s[0],coords:s[1]});c.value=c.value.reverse()}o();async function i(){return new Promise((e,s)=>{navigator.geolocation.getCurrentPosition(t=>e(t),t=>s(t),{enableHighAccuracy:!0})})}function u(e){const s={};for(const t in e){if(M(e[t])){s[t]=u(e[t]);continue}s[t]=e[t]}return s}async function P(){try{a.value=await i(),v.value=!1}catch(e){alert(JSON.stringify(u(e),null,"  "))}}P();const v=y(!1);async function D(){if(a.value)try{await x(a.value.timestamp,u(a.value.coords),d),c.value.unshift(u(a.value)),v.value=!0}catch(e){alert(JSON.stringify(u(e),null,"  "))}}function M(e){return typeof e=="object"&&!Array.isArray(e)&&e!==null}async function Y(){const e=[...c.value];e.sort((t,l)=>t.timestamp-l.timestamp);const s=JSON.stringify(e);return console.log(s),s}async function E(){const e=await Y(),s=L(H(new TextEncoder().encode(e)));if(!navigator.canShare){alert("Sharing is not supported"),console.log("pointsTextEnc"),console.log(s);return}const t={title:s};try{await navigator.share(t)}catch(l){alert(JSON.stringify(u(l),null,"  "))}}async function I(e){const s=new TextDecoder().decode(J(V(e))),t=JSON.parse(s);console.log(t);for(const l of t)await x(l.timestamp,u(l.coords),d);await o()}return globalThis.importPoints=I,(e,s)=>(p(),_(m,null,[n("div",q,[n("button",{onClick:P},"Update Point"),n("button",{onClick:D,disabled:v.value},"Save Point",8,G),n("button",{onClick:E},"Share"),a.value?(p(),_("table",R,[(p(!0),_(m,null,g(Object.entries(u(a.value.coords)).filter(([t,l])=>l),([t,l])=>(p(),_("tr",null,[n("td",null,f(t),1),S(": "),n("td",null,f(l),1)]))),256)),n("tr",U,[K,S(": "),n("td",null,f(O(N)(a.value.timestamp,"YYYY.MM.DD HH:mm:SS",!1)),1)])])):w("",!0)]),n("div",z,[c.value.length?(p(),_("div",Q,[W,(p(!0),_(m,null,g(c.value,t=>(p(),_("div",null,[n("div",X,f(O(N)(t.timestamp,"YYYY.MM.DD HH:mm:SS",!1)),1),(p(!0),_(m,null,g(Object.entries(t.coords).filter(([l,h])=>h),([l,h])=>(p(),_("div",null,[n("span",null,f(l),1),S(": "),n("span",null,f(h),1)]))),256)),Z]))),256))])):w("",!0)])],64))}});const C=(r,d)=>{const a=r.__vccOpts||r;for(const[c,o]of d)a[c]=o;return a},te=C(ee,[["__scopeId","data-v-47dca62f"]]),oe=r=>(j("data-v-2724c669"),r=r(),A(),r),se=oe(()=>n("a",{class:"readme",title:"Open Readme",href:"https://github.com/AlttiRi/gps-test",target:"_blank"},[n("i",null,"i")],-1)),ne=k({__name:"App",setup(r){return(d,a)=>(p(),_(m,null,[F(te),se],64))}});const ae=C(ne,[["__scopeId","data-v-2724c669"]]);$(ae).mount("#app");
//# sourceMappingURL=index.js.map
